<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Live TV Streaming</title>
  <style>
    body {
      font-family: Arial, Helvetica, sans-serif;
      background-color: #f0f0f0;
      margin: 0;
      padding: 20px;
    }

    h1 {
      text-align: center;
      color: #333;
      margin-bottom: 20px;
    }

    .channel {
      display: inline-block;
      margin: 15px;
      text-align: center;
      width: calc(20% - 30px); /* 5 channels in a row with spacing */
      max-width: 200px; /* Maximum width for larger screens */
      height: 175px;
      background-color: white;
      border-radius: 10px;
      box-shadow: rgba(0, 0, 0, 0.2) 0px 4px 10px;
      transition: transform 0.3s, box-shadow 0.3s;
      overflow: hidden;
    }

    .channel:hover {
      transform: scale(1.05);
      box-shadow: rgba(0, 0, 0, 0.4) 0px 8px 20px;
    }

    .channel img {
      width: 80%;
      height: 120px;
      object-fit: cover;
      border-top-left-radius: 10px;
      border-top-right-radius: 10px;
      margin-top: 9px;
      margin-bottom: 9px;
    }

    .channel button {
      color: white;
      background: red;
      width: 120px;
      height: 30px;
      border: none;
      border-radius: 5px;
      cursor: pointer;
      transition: background-color 0.3s;
    }

    .channel button:hover {
      background-color: darkred;
    }

    .container {
      display: flex;
      flex-direction: row;
      flex-wrap: wrap;
      justify-content: center;
      align-items: center;
      margin-top: 20px;
    }

    .main {
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    /* Responsive adjustments */
    @media (max-width: 1200px) {
      .channel {
        width: calc(25% - 30px); /* 4 channels in a row */
      }
    }

    @media (max-width: 900px) {
      .channel {
        width: calc(33.33% - 30px); /* 3 channels in a row */
      }
    }

    @media (max-width: 600px) {
      .channel {
        width: calc(50% - 30px); /* 2 channels in a row */
      }

      .channel img {
        height: 80px; /* Adjusted image height for smaller screens */
      }

      .channel button {
        width: 100%; /* Button full width */
      }
    }

    @media (max-width: 200px) {
      .channel {
        width: 60%; /* Full width for very small screens */
        
      }

      .channel img {
        width: 80%;
        height: 90px; /* Further reduced image height */
        margin-top: 15px;
        margin-bottom: 20px;
      }
    }
  </style>
</head>
<body>
  <div class="main">
    <h1>Live TV Streaming</h1>
    <div class="container">
      <div id="channels"></div>
    </div>
  </div>
  
  <script>
    // Load M3U playlist and parse the data
    async function loadPlaylist() {
      try {
        const response = await fetch('playlist.m3u8'); // Update this with your playlist URL
        const text = await response.text();
        const lines = text.split('\n');
        let channels = [];

        for (let i = 0; i < lines.length; i++) {
          if (lines[i].startsWith("#EXTINF")) {
            const name = lines[i].match(/,(.*)/)[1].trim();
            const logoMatch = lines[i].match(/tvg-logo="(.*?)"/);
            const logo = logoMatch ? logoMatch[1] : ''; // Use empty string if logo is missing
            const url = lines[i + 1].trim();
            channels.push({ name, logo, url });
          }
        }

        const channelContainer = document.getElementById('channels');
        channels.forEach(channel => {
          const channelDiv = document.createElement('div');
          channelDiv.className = 'channel';
          channelDiv.innerHTML = `
            <img src="${channel.logo}" alt="${channel.name}">
            <button onclick="openPlayer('${channel.url}')">Watch Now</button>
          `;
          channelContainer.appendChild(channelDiv);
        });
      } catch (error) {
        console.error('Error loading playlist:', error);
        document.getElementById('channels').innerHTML = '<p style="color:red;">Failed to load channels</p>';
      }
    }

    // Open the Clappr player in a new tab
    function openPlayer(streamUrl) {
      const playerWindow = window.open('player.html?stream=' + encodeURIComponent(streamUrl), '_blank');
      if (playerWindow) {
        playerWindow.focus();
      } else {
        alert('Please allow popups for this website');
      }
    }

    loadPlaylist();
  </script>
</body>
</html>
